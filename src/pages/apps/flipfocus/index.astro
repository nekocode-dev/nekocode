---
import BaseLayout from '@/layouts/BaseLayout.astro';
import FlipFocusNav from '@/components/nav/FlipFocusNav.astro';
import Footer from '@/components/nav/Footer.astro';
import Container from '@/components/layout/Container.astro';
import Section from '@/components/layout/Section.astro';
import Button from '@/components/ui/Button.astro';
import Tag from '@/components/ui/Tag.astro';

const base = import.meta.env.BASE_URL;

// Enhanced features with detailed info for modals
const features = [
  { 
    id: 'fsrs',
    icon: 'üß†', 
    title: 'FSRS-5 Algorithm', 
    description: 'State-of-the-art spaced repetition that adapts to your memory patterns.',
    details: {
      subtitle: 'Science-Backed Memory Optimization',
      points: [
        '20-30% better efficiency than traditional SRS',
        'Personalized learning curves for each card',
        'Optimal scheduling based on your memory patterns',
        'Difficulty analysis and performance insights',
        'Customizable algorithm parameters'
      ]
    }
  },
  { 
    id: 'games',
    icon: 'üéÆ', 
    title: '7+ Game Modes', 
    description: 'Memory Match, Speed Match, Typing Race, Streak Challenge & more.',
    details: {
      subtitle: 'Make Learning Addictively Fun',
      points: [
        'Quick Match - Select correct definitions fast',
        'True/False Lightning - Rapid-fire rounds',
        'Word Scramble - Unscramble to build memory',
        'Typing Race - Type answers against the clock',
        'Streak Challenge - Endless mode, beat high scores',
        'Speed Match - Match terms before time runs out',
        'Fill-in-the-Blank - Complete sentences from cloze cards'
      ]
    }
  },
  { 
    id: 'wifi',
    icon: 'üì°', 
    title: 'WiFi Direct Sharing', 
    description: 'Share flashcards with nearby devices - no internet required.',
    details: {
      subtitle: 'Peer-to-Peer Content Sharing',
      points: [
        'Share decks with friends instantly',
        'No cloud upload or account needed',
        'Works completely offline',
        'Fast transfer via WiFi Direct',
        'Perfect for study groups and classrooms'
      ]
    }
  },
  { 
    id: 'ocr',
    icon: 'üì∑', 
    title: 'OCR Scanning', 
    description: 'Scan textbooks, notes, or any text with your camera instantly.',
    details: {
      subtitle: 'Camera-Powered Card Creation',
      points: [
        'Scan printed text from any source',
        'Automatic text recognition',
        'Create flashcards from photos instantly',
        'Supports multiple languages',
        'Works offline with on-device processing'
      ]
    }
  },
  { 
    id: 'privacy',
    icon: 'üîí', 
    title: 'Local-First Data', 
    description: 'Your study content stays on your device. We value your privacy.',
    details: {
      subtitle: 'Your Data, Your Control',
      points: [
        'All study content stored locally',
        'No account required for core features',
        'SQLCipher encrypted database',
        'Transparent ad-supported model',
        'Export and backup whenever you want'
      ]
    }
  },
  { 
    id: 'offline',
    icon: 'üì¥', 
    title: 'Offline Ready', 
    description: 'Study anywhere without internet. Core features work completely offline.',
    details: {
      subtitle: 'Learn Anywhere, Anytime',
      points: [
        'All study features work offline',
        'No wifi or data needed',
        'Perfect for flights, commutes, travel',
        'Sync optional features when online',
        'Never lose access to your cards'
      ]
    }
  },
  { 
    id: 'cards',
    icon: 'üìù', 
    title: '3 Card Types', 
    description: 'Text, Cloze, and Multiple Choice.',
    details: {
      subtitle: 'Rich Multimedia Flashcards',
      points: [
        'Text Cards - Rich text with markdown',
        'Cloze Deletion - Fill-in-the-blank mastery',
        'Multiple Choice - Interactive quizzes'
      ]
    }
  },
  { 
    id: 'tts',
    icon: 'üîä', 
    title: 'Text-to-Speech', 
    description: 'Listen to your flashcards with natural TTS for language learning.',
    details: {
      subtitle: 'Audio Learning Support',
      points: [
        'Natural sounding voices',
        'Multiple language support',
        'Perfect for pronunciation practice',
        'Hands-free study sessions',
        'Adjustable speech rate'
      ]
    }
  },
  { 
    id: 'import',
    icon: 'üîÑ', 
    title: 'Universal Import', 
    description: 'Import from Anki, Quizlet, or CSV. Migrate your entire library.',
    details: {
      subtitle: 'Seamless Migration',
      points: [
        'Anki .apkg full compatibility',
        'Quizlet study sets import',
        'CSV bulk import from spreadsheets',
        'Preserve all images and audio',
        'Export to multiple formats'
      ]
    }
  },
];

// Updated stats to reflect actual app capabilities
const stats = [
  { value: '7+', label: 'Game Modes' },
  { value: 'FSRS-5', label: 'Algorithm' },
  { value: 'Offline', label: 'Ready' },
  { value: '3', label: 'Card Types' },
];



// App Store links
const googlePlayUrl = 'https://play.google.com/store/apps/details?id=com.nekocode.flipfocus';
const appStoreUrl = ''; // Empty = coming soon
---

<BaseLayout 
  title="FlipFocus | Smart Flashcard App"
  description="FlipFocus - The ultimate offline-first flashcard app with FSRS-5 spaced repetition, gamification, OCR scanning, and privacy-first design."
>
  <FlipFocusNav slot="header" />
  
  <!-- Hero Section -->
  <Section size="xl" class="hero-section">
    <Container>
      <div class="hero-grid">
        <div class="hero-content reveal-left">
          <div class="hero-badge">
            <span>üé¥ Offline Ready ‚Ä¢ Local Data</span>
          </div>
          
          <h1 class="text-hero">
            <span class="gradient-text">Master Anything</span><br/>
            With Smart Flashcards
          </h1>
          
          <p class="hero-description">
            FlipFocus uses the scientifically-proven <strong>FSRS-5 algorithm</strong> to optimize your learning. 
            Study smarter with gamification, OCR scanning, and complete privacy.
          </p>
          
          <div class="hero-actions">
            <Button href="#download" variant="accent" size="lg">Download Now</Button>
            <Button href="/apps/flipfocus/pricing" variant="secondary" size="lg">View Pricing</Button>
          </div>
        </div>
        
        <div class="phone-mockup">
          <div class="phone-glow"></div>
          <div class="phone-float-wrapper">
            <div class="phone-frame">
              <div class="phone-screen">
                <div class="phone-content">
                  <img src={`${base}assets/projects/flipfocus/icon.png`} alt="FlipFocus" class="app-icon" />
                  <span class="app-name">FlipFocus</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </Container>
  </Section>
  
  <!-- Stats Section -->
  <Section class="stats-section">
    <Container size="narrow">
      <div class="stats-grid glass-panel">
        {stats.map((stat, index) => (
          <div class={`stat-item reveal stagger-${index + 1}`}>
            <div class="stat-value" data-counter={stat.value}>{stat.value}</div>
            <div class="stat-label">{stat.label}</div>
          </div>
        ))}
      </div>
    </Container>
  </Section>
  
  <!-- Features Section -->
  <Section id="features" size="lg" class="features-section">
    <Container>
      <div class="section-header reveal">
        <Tag variant="accent">Features</Tag>
        <h2 class="text-title-1">Everything you need to learn effectively</h2>
        <p class="section-subtitle">Click any feature to learn more</p>
      </div>
      
      <div class="features-grid">
        {features.map(feature => (
          <button 
            class="feature-card" 
            data-feature={feature.id}
            aria-label={`Learn more about ${feature.title}`}
          >
            <span class="feature-icon">{feature.icon}</span>
            <h3>{feature.title}</h3>
            <p>{feature.description}</p>
            <span class="feature-expand">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M12 8v8M8 12h8"/>
              </svg>
            </span>
          </button>
        ))}
      </div>
    </Container>
  </Section>
  

  
  <!-- Download Section -->
  <Section id="download" size="lg" class="download-section">
    <Container size="narrow">
      <div class="download-card glass-panel">
        <img src={`${base}assets/projects/flipfocus/icon.png`} alt="FlipFocus" class="download-icon" />
        <h2 class="text-title-1">Get FlipFocus</h2>
        <p class="download-description">Start your learning journey today. Free to use with optional Pro features.</p>
        
        <div class="download-buttons">
          {googlePlayUrl ? (
            <a href={googlePlayUrl} target="_blank" rel="noopener noreferrer" class="store-button">
              <svg class="store-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M3,20.5V3.5C3,2.91 3.34,2.39 3.84,2.15L13.69,12L3.84,21.85C3.34,21.6 3,21.09 3,20.5M16.81,15.12L6.05,21.34L14.54,12.85L16.81,15.12M20.16,10.81C20.5,11.08 20.75,11.5 20.75,12C20.75,12.5 20.5,12.92 20.16,13.19L17.89,14.5L15.39,12L17.89,9.5L20.16,10.81M6.05,2.66L16.81,8.88L14.54,11.15L6.05,2.66Z"/></svg>
              Google Play
            </a>
          ) : (
            <button disabled class="store-button disabled">
              <svg class="store-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M3,20.5V3.5C3,2.91 3.34,2.39 3.84,2.15L13.69,12L3.84,21.85C3.34,21.6 3,21.09 3,20.5M16.81,15.12L6.05,21.34L14.54,12.85L16.81,15.12M20.16,10.81C20.5,11.08 20.75,11.5 20.75,12C20.75,12.5 20.5,12.92 20.16,13.19L17.89,14.5L15.39,12L17.89,9.5L20.16,10.81M6.05,2.66L16.81,8.88L14.54,11.15L6.05,2.66Z"/></svg>
              Android Coming Soon
            </button>
          )}
          
          {appStoreUrl ? (
            <a href={appStoreUrl} target="_blank" rel="noopener noreferrer" class="store-button">
              <svg class="store-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M18.71,19.5C17.88,20.74 17,21.95 15.66,21.97C14.32,22 13.89,21.18 12.37,21.18C10.84,21.18 10.37,21.95 9.1,22C7.79,22.05 6.8,20.68 5.96,19.47C4.25,17 2.94,12.45 4.7,9.39C5.57,7.87 7.13,6.91 8.82,6.88C10.1,6.86 11.32,7.75 12.11,7.75C12.89,7.75 14.37,6.68 15.92,6.84C16.57,6.87 18.39,7.1 19.56,8.82C19.47,8.88 17.39,10.1 17.41,12.63C17.44,15.65 20.06,16.66 20.09,16.67C20.06,16.74 19.67,18.11 18.71,19.5M13,3.5C13.73,2.67 14.94,2.04 15.94,2C16.07,3.17 15.6,4.35 14.9,5.19C14.21,6.04 13.07,6.7 11.95,6.61C11.8,5.46 12.36,4.26 13,3.5Z"/></svg>
              App Store
            </a>
          ) : (
            <button disabled class="store-button disabled">
              <svg class="store-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M18.71,19.5C17.88,20.74 17,21.95 15.66,21.97C14.32,22 13.89,21.18 12.37,21.18C10.84,21.18 10.37,21.95 9.1,22C7.79,22.05 6.8,20.68 5.96,19.47C4.25,17 2.94,12.45 4.7,9.39C5.57,7.87 7.13,6.91 8.82,6.88C10.1,6.86 11.32,7.75 12.11,7.75C12.89,7.75 14.37,6.68 15.92,6.84C16.57,6.87 18.39,7.1 19.56,8.82C19.47,8.88 17.39,10.1 17.41,12.63C17.44,15.65 20.06,16.66 20.09,16.67C20.06,16.74 19.67,18.11 18.71,19.5M13,3.5C13.73,2.67 14.94,2.04 15.94,2C16.07,3.17 15.6,4.35 14.9,5.19C14.21,6.04 13.07,6.7 11.95,6.61C11.8,5.46 12.36,4.26 13,3.5Z"/></svg>
              iOS Coming Soon
            </button>
          )}
        </div>
        
        <p class="download-note">Free (Ad-Supported) ‚Ä¢ No account required</p>
      </div>
    </Container>
  </Section>
  
  <!-- Legal Links -->
  <Section class="legal-section">
    <Container size="narrow">
      <div class="legal-links">
        <a href={`${base}apps/flipfocus/privacy`}>Privacy Policy</a>
        <span class="divider">‚Ä¢</span>
        <a href={`${base}apps/flipfocus/terms`}>Terms of Service</a>
      </div>
    </Container>
  </Section>
  
  <!-- Feature Modal -->
  <div id="feature-modal" class="modal-overlay" aria-hidden="true">
    <div class="modal-backdrop"></div>
    <div class="modal-content glass-panel" role="dialog" aria-modal="true">
      <button class="modal-close" aria-label="Close modal">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </button>
      <div class="modal-icon"></div>
      <h3 class="modal-title"></h3>
      <p class="modal-subtitle"></p>
      <ul class="modal-details"></ul>
    </div>
  </div>
  
  <Footer slot="footer" />
</BaseLayout>

<script define:vars={{ features }}>
  document.addEventListener('astro:page-load', () => {
    // Feature modal functionality
    const modal = document.getElementById('feature-modal');
    if (!modal) return; // Exit if modal doesn't exist on this page

    const modalBackdrop = modal.querySelector('.modal-backdrop');
    const modalContent = modal.querySelector('.modal-content');
    const modalClose = modal.querySelector('.modal-close');
    const modalIcon = modal.querySelector('.modal-icon');
    const modalTitle = modal.querySelector('.modal-title');
    const modalSubtitle = modal.querySelector('.modal-subtitle');
    const modalDetails = modal.querySelector('.modal-details');
    
    // Core Logic (Same as before)
    const featureData = features;
    let lastSourceElement = null;
    
    // Define functions strictly inside the scope or check if they exist globally
    // For simplicity with Astro transitions, defining them inside the event listener is safest
    const openModal = (featureId, sourceElement) => {
      const feature = featureData.find(f => f.id === featureId);
      if (!feature || !modal) return;
      
      modalIcon.textContent = feature.icon;
      modalTitle.textContent = feature.title;
      modalSubtitle.textContent = feature.details.subtitle;
      modalDetails.innerHTML = feature.details.points
        .map(point => `<li>${point}</li>`)
        .join('');
      
      // Animation Logic
      if (sourceElement) {
        lastSourceElement = sourceElement;
        const cardRect = sourceElement.getBoundingClientRect();
        
        modal.style.visibility = 'hidden'; 
        modal.style.display = 'flex';
        modal.classList.add('active');
        
        const modalRect = modalContent.getBoundingClientRect();
        
        const translateX = (cardRect.left + cardRect.width / 2) - (modalRect.left + modalRect.width / 2);
        const translateY = (cardRect.top + cardRect.height / 2) - (modalRect.top + modalRect.height / 2);
        const scaleX = cardRect.width / modalRect.width;
        const scaleY = cardRect.height / modalRect.height;
        
        modal.classList.remove('active');
        modal.style.visibility = '';
        modal.style.display = '';

        modalContent.style.transition = 'none';
        modalContent.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scaleX}, ${scaleY})`;
        modalContent.style.transformOrigin = 'center center';
        
        modal.classList.add('active');
        modal.setAttribute('aria-hidden', 'false');
        document.body.style.overflow = 'hidden';
        
        modalContent.offsetHeight;
        
        requestAnimationFrame(() => {
          modalContent.style.transition = 'transform 0.5s cubic-bezier(0.2, 0.8, 0.2, 1)';
          modalContent.style.transform = '';
        });
        
        setTimeout(() => {
          if (modalContent) {
            modalContent.style.transition = '';
            modalContent.style.transformOrigin = '';
          }
        }, 500);

      } else {
        modal.classList.add('active');
        modal.setAttribute('aria-hidden', 'false');
        document.body.style.overflow = 'hidden';
      }
      
      setTimeout(() => modalClose?.focus(), 50);
    };
    
    const closeModal = () => {
      if (!modal) return;
      
      if (lastSourceElement && modal.classList.contains('active')) {
        const cardRect = lastSourceElement.getBoundingClientRect();
        const modalRect = modalContent.getBoundingClientRect();
        
        const translateX = (cardRect.left + cardRect.width / 2) - (modalRect.left + modalRect.width / 2);
        const translateY = (cardRect.top + cardRect.height / 2) - (modalRect.top + modalRect.height / 2);
        const scaleX = cardRect.width / modalRect.width;
        const scaleY = cardRect.height / modalRect.height;
        
        modalContent.style.transition = 'transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1)';
        modalContent.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scaleX}, ${scaleY})`;
        
        modal.style.opacity = '0';
        
        setTimeout(() => {
          modal.classList.remove('active');
          modal.setAttribute('aria-hidden', 'true');
          modal.style.opacity = '';
          modal.style.display = '';
          document.body.style.overflow = '';
          
          if (modalContent) {
            modalContent.style.transition = '';
            modalContent.style.transform = '';
          }
          lastSourceElement = null;
        }, 400);
        
      } else {
        modal.classList.remove('active');
        modal.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
        
        if (modalContent) {
          modalContent.style.transition = '';
          modalContent.style.transform = '';
        }
      }
    };
    
    // Event listeners - using handlers that don't need persistent references for removal 
    // because astro:page-load re-runs on navigation, and new DOM elements are created.
    document.querySelectorAll('.feature-card').forEach(card => {
      card.addEventListener('click', () => {
        const featureId = card.getAttribute('data-feature');
        if (featureId) openModal(featureId, card);
      });
    });
    
    modalClose?.addEventListener('click', closeModal);
    modalBackdrop?.addEventListener('click', closeModal);
    
    // Keydown listener needs to be careful not to duplicate if valid across navigations, 
    // but typically it's cleaned up by the browser when the Document is replaced, 
    // OR we should remove it in astro:before-preparation if persisting.
    // simpler: just add it, but since we are inside a module script, it might persist?
    // standard practice: use a named function and remove it on cleanup
    
    const handleKeydown = (e) => {
      if (e.key === 'Escape' && modal?.classList.contains('active')) {
        closeModal();
      }
    };
    document.addEventListener('keydown', handleKeydown);


    // Interactive Phone Animation
    const heroSection = document.querySelector('.hero-section');
    const phoneFrame = document.querySelector('.phone-frame');

    if (heroSection && phoneFrame) {
      const handleMouseMove = (e) => {
        const { left, top, width, height } = heroSection.getBoundingClientRect();
        const x = (e.clientX - left) / width - 0.5;
        const y = (e.clientY - top) / height - 0.5;
        
        // Calculate tilt (limit to +/- 20 degrees)
        const tiltX = y * -20; 
        const tiltY = x * 20;
        
        phoneFrame.style.setProperty('--tilt-x', `${tiltX}deg`);
        phoneFrame.style.setProperty('--tilt-y', `${tiltY}deg`);
      };

      const handleMouseLeave = () => {
        phoneFrame.style.setProperty('--tilt-x', '0deg');
        phoneFrame.style.setProperty('--tilt-y', '0deg');
      };

      heroSection.addEventListener('mousemove', handleMouseMove);
      heroSection.addEventListener('mouseleave', handleMouseLeave);
    }
  });
</script>

<style>
  /* Hero */
  .hero-section {
    position: relative;
    overflow: hidden;
  }
  
  .hero-section::before {
    content: '';
    position: absolute;
    top: 20%;
    left: 20%;
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, rgba(var(--color-accent-rgb, 193, 154, 107), 0.15) 0%, transparent 70%);
    pointer-events: none;
  }
  
  .hero-section::after {
    content: '';
    position: absolute;
    bottom: 20%;
    right: 20%;
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, rgba(100, 149, 237, 0.1) 0%, transparent 70%);
    pointer-events: none;
  }
  
  .hero-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-12);
    align-items: center;
  }
  
  @media (max-width: 768px) {
    .hero-grid {
      grid-template-columns: 1fr;
      text-align: center;
    }
  }
  
  .hero-badge {
    display: inline-block;
    padding: var(--space-2) var(--space-4);
    background: rgba(var(--color-accent-rgb, 193, 154, 107), 0.15);
    border: 1px solid rgba(var(--color-accent-rgb, 193, 154, 107), 0.3);
    border-radius: var(--radius-full);
    font-size: var(--text-sm);
    color: var(--color-accent);
    margin-bottom: var(--space-6);
  }
  
  .gradient-text {
    background: linear-gradient(135deg, var(--color-accent), #d4b896);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  
  .hero-content h1 {
    margin-bottom: var(--space-6);
  }
  
  .hero-description {
    font-size: var(--text-lg);
    color: var(--color-text-secondary);
    line-height: 1.7;
    margin-bottom: var(--space-8);
    max-width: 500px;
  }
  
  .hero-description strong {
    color: var(--color-text);
  }
  
  .hero-actions {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-4);
  }
  
  @media (max-width: 768px) {
    .hero-description {
      margin-inline: auto;
    }
    .hero-actions {
      justify-content: center;
    }
  }
  
  /* Phone Mockup with Enhanced 3D Effect */
  .phone-mockup {
    display: flex;
    justify-content: center;
    position: relative;
    perspective: 1000px;
    z-index: 10;
  }
  
  .phone-glow {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 350px;
    height: 600px;
    background: radial-gradient(ellipse, rgba(var(--color-accent-rgb, 193, 154, 107), 0.3) 0%, transparent 70%);
    filter: blur(50px);
    pointer-events: none;
    animation: pulse-glow 5s ease-in-out infinite alternate;
    z-index: -1;
  }
  
  @keyframes pulse-glow {
    0% { opacity: 0.5; transform: translate(-50%, -50%) scale(0.9); }
    100% { opacity: 0.8; transform: translate(-50%, -50%) scale(1.1); }
  }
  
  .phone-float-wrapper {
    transform-style: preserve-3d;
    animation: float-bob 6s ease-in-out infinite;
  }

  @keyframes float-bob {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-20px); }
  }

  .phone-frame {
    background: #000;
    border-radius: 50px;
    padding: 12px;
    box-shadow: 
      0 0 0 2px #333,
      0 0 0 4px #1a1a1a,
      0 20px 40px rgba(0, 0, 0, 0.4),
      0 40px 80px rgba(0, 0, 0, 0.3);
    position: relative;
    transform-style: preserve-3d;
    
    /* Interactive Tilt Configuration */
    transform: rotateX(var(--tilt-x, 0deg)) rotateY(var(--tilt-y, 0deg));
    transition: transform 0.1s cubic-bezier(0.2, 0, 0.2, 1); /* Smooth but snappy follow */
    
    width: 300px;
    height: 600px;
    will-change: transform; /* Performance optimization */
  }

  /* Dynamic Island / Notch */
  .phone-frame::before {
    content: '';
    position: absolute;
    top: 24px;
    left: 50%;
    transform: translateX(-50%);
    width: 90px;
    height: 24px;
    background: #000;
    border-radius: 12px;
    z-index: 20;
  }

  /* Side Buttons */
  .phone-frame::after {
    content: '';
    position: absolute;
    top: 100px;
    right: -6px;
    width: 4px;
    height: 60px;
    background: #2a2a2a;
    border-radius: 2px;
  }
  
  .phone-screen {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #1a1a24 0%, #222230 100%);
    border-radius: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid rgba(255, 255, 255, 0.1);
    position: relative;
    overflow: hidden;
  }
  
  /* Screen Glare */
  .phone-screen::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -100%;
    width: 200%;
    height: 200%;
    background: linear-gradient(
      45deg,
      transparent 40%,
      rgba(255, 255, 255, 0.05) 45%,
      transparent 50%
    );
    transform: rotate(25deg);
    pointer-events: none;
    z-index: 10;
  }
  
  .phone-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-8);
    transform: translateZ(20px);
  }
  
  .app-icon {
    width: 120px;
    height: 120px;
    border-radius: 28px;
    box-shadow: 
      0 8px 24px rgba(0, 0, 0, 0.3),
      0 16px 48px rgba(0, 0, 0, 0.2);
    /* Icon floats slightly separate from phone for depth */
    animation: float 6s ease-in-out infinite;
  }
  
  .app-name {
    font-family: var(--font-display);
    font-size: var(--text-4xl);
    font-weight: 800;
    background: linear-gradient(135deg, #fff 0%, #e0e0e0 100%);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    letter-spacing: -0.03em;
  }
  
  @keyframes float-3d {
    0% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
    100% { transform: translateY(0); }
  }
  
  /* Stats */
  .stats-section {
    margin-top: calc(var(--space-8) * -1);
  }
  
  .glass-panel {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: var(--radius-2xl);
  }
  
  [data-theme="light"] .glass-panel {
    background: rgba(255, 255, 255, 0.8);
    border-color: rgba(0, 0, 0, 0.08);
  }
  
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--space-8);
    padding: var(--space-8);
    text-align: center;
  }
  
  @media (max-width: 600px) {
    .stats-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
  
  .stat-value {
    font-size: var(--text-4xl);
    font-weight: 700;
    background: linear-gradient(135deg, var(--color-accent), #82c4b5);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  
  .stat-label {
    font-size: var(--text-sm);
    color: var(--color-muted);
    margin-top: var(--space-2);
  }
  
  /* Features */
  .section-header {
    text-align: center;
    margin-bottom: var(--space-12);
  }
  
  .section-header h2 {
    margin-top: var(--space-4);
  }
  
  .section-subtitle {
    color: var(--color-text-secondary);
    margin-top: var(--space-2);
    font-size: var(--text-base);
  }
  
  .features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: var(--space-6);
  }
  
  .feature-card {
    padding: var(--space-6);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    transition: all var(--duration-normal) var(--ease-out);
    cursor: pointer;
    text-align: left;
    position: relative;
    font-family: inherit;
    width: 100%;
  }
  
  .feature-card:hover {
    border-color: var(--color-accent);
    transform: translateY(-4px);
    box-shadow: 
      var(--shadow-lg),
      0 0 30px rgba(var(--color-accent-rgb, 193, 154, 107), 0.15);
  }
  
  .feature-card:active {
    transform: translateY(-2px);
  }
  
  .feature-expand {
    position: absolute;
    top: var(--space-4);
    right: var(--space-4);
    opacity: 0.4;
    transition: opacity var(--duration-fast) var(--ease-out);
    color: var(--color-accent);
  }
  
  .feature-card:hover .feature-expand {
    opacity: 1;
  }
  
  .feature-icon {
    font-size: var(--text-3xl);
    display: block;
    margin-bottom: var(--space-4);
  }
  
  .feature-card h3 {
    font-family: var(--font-display);
    font-size: var(--text-lg);
    font-weight: 600;
    color: var(--color-text);
    margin: 0 0 var(--space-2);
  }
  
  .feature-card p {
    font-size: var(--text-sm);
    color: var(--color-text-secondary);
    margin: 0;
    line-height: 1.6;
  }
  

  }
  
  .pricing-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--space-8);
    max-width: 800px;
    margin: 0 auto;
  }
  
  .pricing-card {
    padding: var(--space-8);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-2xl);
    position: relative;
    transition: all var(--duration-normal) var(--ease-out);
  }
  
  .pricing-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-xl);
  }
  
  .pricing-card.pro {
    border-color: var(--color-accent);
    background: linear-gradient(135deg, rgba(var(--color-accent-rgb, 193, 154, 107), 0.05) 0%, var(--color-surface) 100%);
  }
  
  .popular-badge {
    position: absolute;
    top: -12px;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(135deg, var(--color-accent), #d4b896);
    color: var(--color-bg);
    padding: var(--space-2) var(--space-4);
    border-radius: var(--radius-full);
    font-size: var(--text-sm);
    font-weight: 600;
    white-space: nowrap;
  }
  
  .pricing-header {
    text-align: center;
    margin-bottom: var(--space-6);
    padding-bottom: var(--space-6);
    border-bottom: 1px solid var(--color-border);
  }
  
  .pricing-name {
    font-size: var(--text-xl);
    font-weight: 600;
    margin: 0 0 var(--space-4);
  }
  
  .pricing-price {
    display: flex;
    align-items: baseline;
    justify-content: center;
    gap: var(--space-1);
  }
  
  .price-amount {
    font-size: var(--text-5xl);
    font-weight: 700;
    background: linear-gradient(135deg, var(--color-accent), #82c4b5);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  
  .price-period {
    color: var(--color-text-secondary);
    font-size: var(--text-base);
  }
  
  .yearly-price {
    margin-top: var(--space-2);
    color: var(--color-text-secondary);
    font-size: var(--text-sm);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
  }
  
  .save-badge {
    background: rgba(34, 197, 94, 0.15);
    color: #22c55e;
    padding: 2px 8px;
    border-radius: var(--radius-full);
    font-size: var(--text-xs);
    font-weight: 600;
  }
  
  .pricing-features {
    list-style: none;
    padding: 0;
    margin: 0 0 var(--space-8);
  }
  
  .pricing-features li {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-3) 0;
    font-size: var(--text-sm);
    color: var(--color-text-secondary);
  }
  
  .check-icon {
    width: 18px;
    height: 18px;
    color: var(--color-accent);
    flex-shrink: 0;
  }
  
  .pricing-cta {
    width: 100%;
    justify-content: center;
  }
  
  .trial-note {
    text-align: center;
    margin-top: var(--space-3);
    font-size: var(--text-sm);
    color: var(--color-muted);
  }
  
  /* Download */
  .download-section {
    text-align: center;
  }
  
  .download-card {
    padding: var(--space-12);
  }
  
  .download-icon {
    width: 96px;
    height: 96px;
    border-radius: 24px;
    margin-bottom: var(--space-6);
  }
  
  .download-card h2 {
    margin-bottom: var(--space-4);
  }
  
  .download-description {
    color: var(--color-text-secondary);
    margin-bottom: var(--space-8);
    max-width: 400px;
    margin-inline: auto;
  }
  
  .download-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: var(--space-4);
    margin-bottom: var(--space-6);
  }
  
  .store-button {
    display: inline-flex;
    align-items: center;
    justify-content: center; /* Center content */
    gap: var(--space-3);
    padding: var(--space-4) var(--space-8);
    background: var(--color-text);
    color: var(--color-bg);
    font-weight: 600;
    border-radius: var(--radius-xl);
    text-decoration: none;
    transition: all var(--duration-fast) var(--ease-out);
    border: none;
    cursor: pointer;
    width: 220px; /* Fixed width for perfect matching */
  }
  
  .store-button:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
  }
  
  .store-button.disabled {
    background: var(--color-surface);
    color: var(--color-muted);
    border: 1px solid var(--color-border);
    cursor: not-allowed;
  }
  
  .store-button.disabled:hover {
    transform: none;
    box-shadow: none;
  }
  
  .store-icon {
    width: 24px;
    height: 24px;
  }
  
  .download-note {
    font-size: var(--text-sm);
    color: var(--color-muted);
  }
  
  /* Legal */
  .legal-links {
    display: flex;
    justify-content: center;
    gap: var(--space-4);
    padding: var(--space-8);
  }
  
  .legal-links a {
    color: var(--color-muted);
    font-size: var(--text-sm);
    transition: color var(--duration-fast) var(--ease-out);
  }
  
  .legal-links a:hover {
    color: var(--color-text);
  }
  
  .divider {
    color: var(--color-border);
  }
  
  /* Modal */
  .modal-overlay {
    position: fixed;
    inset: 0;
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transition: opacity var(--duration-normal) var(--ease-out), visibility var(--duration-normal);
  }
  
  .modal-overlay.active {
    opacity: 1;
    visibility: visible;
  }
  
  .modal-backdrop {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(8px);
  }
  
  .modal-content {
    position: relative;
    max-width: 480px;
    width: calc(100% - var(--space-8));
    max-height: calc(100vh - var(--space-16));
    overflow-y: auto;
    padding: var(--space-10);
    transform: scale(0.95) translateY(20px);
    transition: transform var(--duration-normal) var(--ease-out);
  }
  
  .modal-overlay.active .modal-content {
    transform: scale(1) translateY(0);
  }
  
  .modal-close {
    position: absolute;
    top: var(--space-4);
    right: var(--space-4);
    background: none;
    border: none;
    color: var(--color-text-secondary);
    cursor: pointer;
    padding: var(--space-2);
    border-radius: var(--radius-lg);
    transition: all var(--duration-fast) var(--ease-out);
  }
  
  .modal-close:hover {
    color: var(--color-text);
    background: rgba(255, 255, 255, 0.1);
  }
  
  .modal-icon {
    font-size: 4rem;
    text-align: center;
    margin-bottom: var(--space-4);
  }
  
  .modal-title {
    font-size: var(--text-2xl);
    font-weight: 700;
    text-align: center;
    margin: 0 0 var(--space-2);
    background: linear-gradient(135deg, var(--color-accent), #d4b896);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  
  .modal-subtitle {
    text-align: center;
    color: var(--color-text-secondary);
    margin: 0 0 var(--space-6);
    font-size: var(--text-base);
  }
  
  .modal-details {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  
  .modal-details li {
    padding: var(--space-3) 0;
    padding-left: var(--space-6);
    position: relative;
    color: var(--color-text-secondary);
    font-size: var(--text-sm);
    border-bottom: 1px solid rgba(var(--color-border-rgb, 255, 255, 255), 0.05);
  }
  
  .modal-details li:last-child {
    border-bottom: none;
  }
  
  .modal-details li::before {
    content: '‚úì';
    position: absolute;
    left: 0;
    color: var(--color-accent);
    font-weight: bold;
  }
</style>
