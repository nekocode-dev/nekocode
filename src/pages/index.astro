---
import BaseLayout from '@/layouts/BaseLayout.astro';
import NavBar from '@/components/nav/NavBar.astro';
import Footer from '@/components/nav/Footer.astro';
import Container from '@/components/layout/Container.astro';
import Section from '@/components/layout/Section.astro';
import BentoGrid from '@/components/layout/BentoGrid.astro';
import ProjectCard from '@/components/cards/ProjectCard.astro';
import TeamSpotlight from '@/components/cards/TeamSpotlight.astro';
import Button from '@/components/ui/Button.astro';
import Tag from '@/components/ui/Tag.astro';

import { getCollection } from 'astro:content';

// Get featured projects
const allProjects = await getCollection('projects');
// Sort: FlipFocus first, then featured, then others
allProjects.sort((a, b) => {
  if (a.id === 'flipfocus') return -1;
  if (b.id === 'flipfocus') return 1;
  if (a.data.featured && !b.data.featured) return -1;
  if (!a.data.featured && b.data.featured) return 1;
  return 0;
});
const recentProjects = allProjects.slice(0, 6);

const base = import.meta.env.BASE_URL;

const capabilities = [
  { icon: 'üì±', label: 'Mobile Apps' },
  { icon: 'üåê', label: 'Web Development' },
  { icon: 'üé®', label: 'UI/UX Design' },
  { icon: '‚ö°', label: 'Product Strategy' },
  { icon: 'üîß', label: 'Systems Design' },
  { icon: 'üìù', label: 'Documentation' }
];
---

<BaseLayout title="Home">
  <NavBar slot="header" />
  
  <!-- Hero Section -->
  <Section size="xl" class="hero">
    <Container>
      <div class="hero-wrapper">
        <div class="hero-content">

          
          
          <h1 class="text-hero">
            <div class="line-1" data-split-text>Building</div>
            <div class="line-2" data-split-text>products</div>
            <div class="line-3" data-split-text>with craft and</div>
            <div class="line-4" data-split-text>care</div>
          </h1>
          
          <p class="hero-description reveal stagger-2">
            Building software with feline agility and curiosity. Crafting purr-fect digital experiences with nine lives of code.
          </p>
          
          <div class="hero-actions reveal stagger-3">
            <Button href="/work" variant="accent" size="lg">
              View Work
            </Button>
            <Button href="/contact" variant="secondary" size="lg">
              Get in Touch
            </Button>
          </div>
        </div>
        

      </div>
    </Container>
  </Section>
  
  <!-- Featured Work Bento Grid -->
  <Section class="featured-section">
    <Container>
      <div class="section-header reveal">
        <h2 class="text-title-1">APPS & CONCEPTS</h2>
        <Button href="/work" variant="ghost">View All ‚Üí</Button>
      </div>
      
      <BentoGrid columns={3} gap="md">
        {recentProjects.map((project, index) => (
          <ProjectCard
            slug={project.slug}
            title={project.data.title}
            subtitle={project.data.subtitle}
            logo={project.data.media.logo}
            tagline={project.data.tagline}
            coverImage={project.data.media.coverImage}
            type={project.data.type}
            platforms={project.data.platforms}
            tech={project.data.tech}
            status={project.data.status}
            featured={index === 0}
            class={`reveal stagger-${index + 1}`}
          />
        ))}
      </BentoGrid>
    </Container>
  </Section>
  
  <!-- Capabilities Strip -->
  <Section class="capabilities-section">
    <Container>
      <div class="capabilities-grid">
        {capabilities.map((cap, index) => (
          <div class={`capability-item reveal stagger-${index + 1}`}>
            <span class="capability-icon">{cap.icon}</span>
            <span class="capability-label">{cap.label}</span>
          </div>
        ))}
      </div>
    </Container>
  </Section>
  
  <!-- Now Building Module -->
  <Section class="now-section">
    <Container size="narrow">
      <div class="now-card glass reveal-scale">
        <div class="now-header">
          <div class="now-status">
            <Tag variant="accent">Live</Tag>
          </div>
          <div class="now-icon">
             <img src={`${base}assets/projects/flipfocus/icon.png`} alt="FlipFocus" width="80" height="80" class="app-icon" />
          </div>
        </div>
        
        <h3 class="text-title-2">FlipFocus</h3>
        <p class="now-mono">FLASHCARD_SYSTEM // FSRS-5</p>
        <p class="now-description">
          Smart flashcards with spaced repetition, gamification & OCR scanning.
        </p>
        
        <div class="now-actions">
            <Button href="/apps/flipfocus" variant="accent" size="sm">
              View Website
            </Button>
        </div>
      </div>
    </Container>
  </Section>
  
  <!-- Team Spotlight -->
  <Section class="team-section">
    <Container>
      <TeamSpotlight class="reveal" />
    </Container>
  </Section>
  
  <!-- CTA Section -->
  <Section size="lg" class="cta-section">
    <Container size="narrow">
      <div class="cta-content reveal-scale">
        <h2 class="text-title-1">Let's build something great</h2>
        <p class="cta-description">
          Have a project in mind? I'd love to hear about it.
        </p>
        <Button href="/contact" variant="accent" size="lg">
          Start a Conversation
        </Button>
      </div>
    </Container>
  </Section>
  
  <Footer slot="footer" />
</BaseLayout>

<style>
  /* Hero */
  .hero {
    position: relative;
    overflow: hidden;
  }
  
  .hero::before {
    content: '';
    position: absolute;
    top: -50%;
    right: -20%;
    width: 80%;
    height: 200%;
    background: radial-gradient(ellipse, var(--color-glow) 0%, transparent 70%);
    pointer-events: none;
  }
  
  .hero-wrapper {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-8);
  }

  .hero-content {
    position: relative;
    max-width: 640px;
    flex: 1;
  }
  

  

  
  .hero h1 {
    margin-bottom: var(--space-6);
  }
  
  .accent {
    color: var(--color-text);
    background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-hover) 100%);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  
  [data-theme="dark"] .accent {
    background: linear-gradient(135deg, var(--color-accent) 0%, #D4C5B0 100%);
    -webkit-background-clip: text;
    background-clip: text;
  }

  /* Color specific words in hero text */
  /* Line 3: "with craft and" -> craft is 2nd word */
  :global(.line-3 .word:nth-child(2)),
  /* Line 4: "care" -> care is 1st word */
  :global(.line-4 .word:nth-child(1)) {
    color: var(--color-accent);
    position: relative;
    display: inline-block;
  }

  
  .hero-description {
    font-size: var(--text-xl);
    color: var(--color-text-secondary);
    line-height: var(--leading-relaxed);
    margin-bottom: var(--space-8);
    max-width: 560px;
  }
  
  .hero-actions {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-4);
  }
  
  /* Section Header */
  .section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-4);
    margin-bottom: var(--space-8);
  }
  
  .section-header h2 {
    margin: 0;
  }
  
  /* Capabilities */
  .capabilities-section {
    border-top: 1px solid var(--color-border);
    border-bottom: 1px solid var(--color-border);
  }
  
  .capabilities-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: var(--space-6);
    text-align: center;
  }
  
  .capability-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-2);
  }
  
  .capability-icon {
    font-size: var(--text-3xl);
  }
  
  .capability-label {
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--color-text-secondary);
  }
  
  /* Now Building */
  .now-card {
    padding: var(--space-6);
    border-radius: var(--radius-2xl);
    text-align: center;
    position: relative;
    overflow: hidden;
  }
  
  .now-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-4);
    margin-bottom: var(--space-4);
  }

  .now-status {
    position: absolute;
    top: var(--space-4);
    right: var(--space-4);
  }
  
  .now-icon {
    width: 120px;
    height: 120px;
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-lg);
    margin-top: var(--space-6);
  }
  
  .app-icon {
    border-radius: 22%;
    width: 80px;
    height: 80px;
  }
  
  .now-card h3 {
    margin-bottom: var(--space-1);
    color: var(--color-text);
  }
  
  .now-mono {
    font-size: var(--text-xs);
    font-family: var(--font-mono);
    color: var(--color-text-secondary);
    margin-bottom: var(--space-3);
    letter-spacing: 0.05em;
  }
  
  .now-description {
    color: var(--color-text-secondary);
    line-height: var(--leading-relaxed);
    margin-bottom: var(--space-6);
    font-size: var(--text-sm);
  }
  
  .now-actions {
    display: flex;
    justify-content: center;
  }
  
  /* CTA */
  .cta-content {
    text-align: center;
    padding: var(--space-12);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-2xl);
  }
  
  .cta-content h2 {
    margin-bottom: var(--space-4);
  }
  
  .cta-description {
    font-size: var(--text-lg);
    color: var(--color-text-secondary);
    margin-bottom: var(--space-6);
  }
</style>
